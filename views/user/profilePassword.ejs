<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Change Password | Casen</title>
  <!-- ✅ Fixed CDN URLs (no trailing spaces) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.10/dist/cdn.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    body { font-family: 'Inter', sans-serif; }
  </style>
</head>
<body class="bg-gray-50 text-gray-800">
  <!-- Header -->
<header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <!-- Logo -->
            <div class="flex items-center">
                <a href="/">
                    <img src="/logo.png" alt="Logo" class="h-8 object-contain">
                </a>
            </div>

            <!-- Desktop Navigation -->
            <nav class="hidden md:flex space-x-5">
                <a href="/" class="text-sm font-medium transition-opacity hover:opacity-80">Home</a>
                <a href="/about" class="text-sm font-medium transition-opacity hover:opacity-80">About</a>
                <a href="/products" class="text-sm font-medium transition-opacity hover:opacity-80">Phone Cases</a>
                <a href="#" class="text-sm font-medium transition-opacity hover:opacity-80">Tablet Cases</a>
                <a href="/products" class="text-sm font-medium transition-opacity hover:opacity-80">Sale</a>
            </nav>

            <!-- Icons & Auth -->
            <div class="flex items-center space-x-4">
                <!-- Wishlist -->
                <button class="p-2 rounded-full hover:bg-gray-100 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" onclick="window.location.href='/profile/wishlist'">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                    </svg>
                </button>

                <!-- Cart -->
                <button class="p-2 rounded-full hover:bg-gray-100 transition-colors relative" onclick="window.location.href='/cart'">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                    </svg>
                </button>

                <!-- User Menu -->
                <% if (locals.user && user.profilePic) { %>
                <div class="relative" x-data="{ open: false, imageError: false }" @click.away="open = false">
                    <button @click="open = !open" class="rounded-full overflow-hidden w-8 h-8 border border-transparent hover:border-gray-300 transition-colors focus:outline-none">
                        <template x-if="!imageError">
                            <img src="<%= user.profilePic %>" @error="imageError = true" alt="Profile" class="w-full h-full object-cover" />
                        </template>
                        <template x-if="imageError">
                            <div class="w-full h-full bg-gray-300 flex items-center justify-center text-gray-600 rounded-full">
                                <span class="font-medium text-sm"><%= user.name ? user.name.charAt(0).toUpperCase() : 'U' %></span>
                            </div>
                        </template>
                    </button>
                    <div x-show="open"
                         x-transition:enter="transition ease-out duration-150"
                         x-transition:enter-start="opacity-0 scale-95"
                         x-transition:enter-end="opacity-100 scale-100"
                         x-transition:leave="transition ease-in duration-100"
                         x-transition:leave-start="opacity-100 scale-100"
                         x-transition:leave-end="opacity-0 scale-95"
                         class="absolute right-0 mt-2 w-44 bg-white shadow-lg rounded-lg py-1 z-50">
                        <a href="/profile" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors">Profile</a>
                        <form action="/logout" method="post">
                            <button type="submit" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors">Logout</button>
                        </form>
                    </div>
                </div>
                <% } else if (locals.user) { %>
                <div class="relative" x-data="{ open: false }" @click.away="open = false">
                    <button @click="open = !open" class="w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-900 transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                        </svg>
                    </button>
                    <div x-show="open"
                         x-transition:enter="transition ease-out duration-150"
                         x-transition:enter-start="opacity-0 scale-95"
                         x-transition:enter-end="opacity-100 scale-100"
                         x-transition:leave="transition ease-in duration-100"
                         x-transition:leave-start="opacity-100 scale-100"
                         x-transition:leave-end="opacity-0 scale-95"
                         class="absolute right-0 mt-2 w-44 bg-white shadow-lg rounded-lg py-1 z-50">
                        <a href="/profile" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50">Profile</a>
                        <form action="/logout" method="post">
                            <button type="submit" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50">Logout</button>
                        </form>
                    </div>
                </div>
                <% } else { %>
                <a href="/login" class="text-sm font-medium hover: transition-colors flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                    Sign In
                </a>
                <% } %>

                <!-- Mobile Menu Button -->
                <button class="md:hidden text-gray-600 hover:text-gray-900">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
            </div>
        </div>
    </header>

  <div class="container mx-auto px-4 py-8 flex flex-col lg:flex-row gap-6">
    <!-- Sidebar -->
    <aside class="lg:w-60 bg-white rounded-xl shadow-sm overflow-hidden">
      <nav class="p-4 space-y-1">
        <a href="/profile" class="flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors">
          <i class="fas fa-user text-sm"></i>
          <span class="font-medium text-sm">Profile</span>
        </a>
        <a href="/profile/orders" class="flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors">
          <i class="fas fa-shopping-cart text-sm"></i>
          <span class="font-medium text-sm">Orders</span>
        </a>
        <a href="/profile/wishlist" class="flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors">
          <i class="far fa-heart text-sm"></i>
          <span class="font-medium text-sm">Wishlist</span>
        </a>
        <a href="/profile/address" class="flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors">
          <i class="fas fa-home text-sm"></i>
          <span class="font-medium text-sm">Address</span>
        </a>
        <a href="/profile/newPassword" class="flex items-center space-x-3 px-4 py-3 bg-black text-white rounded-lg transition-colors">
          <i class="fas fa-lock text-sm"></i>
          <span class="font-medium text-sm">Password</span>
        </a>
        <a href="/profile/wallet" class="flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors">
          <i class="fas fa-wallet text-sm"></i>
          <span class="font-medium text-sm">Wallet</span>
        </a>
        <a href="/profile/referral" class="flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors">
          <i class="fas fa-users text-sm"></i>
          <span class="font-medium text-sm">Referral</span>
        </a>
        <a href="#" onclick="document.getElementById('logout-form').submit();" class="flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors mt-4">
          <i class="fas fa-sign-out-alt text-sm"></i>
          <span class="font-medium text-sm">Logout</span>
        </a>
        <form id="logout-form" action="/logout" method="post" class="hidden"></form>
      </nav>
    </aside>

    <!-- Main Form -->
    <main class="flex-1 bg-white rounded-xl shadow-sm p-6 md:p-8">
      <div class="mb-8">
        <h1 class="text-2xl md:text-3xl font-bold text-gray-900">Change Password</h1>
        <p class="text-gray-600 mt-2">Keep your account secure with a strong password.</p>
      </div>

      <% if (locals.user && !user.password) { %>
      <div class="bg-blue-50 text-blue-700 px-4 py-3 rounded-lg mb-6 text-sm">
        <i class="fas fa-info-circle mr-2"></i>
        You signed in with <strong>Google</strong>. Setting a password will allow you to log in with your email.
      </div>
      <% } %>

      <form action="/password?_method=PUT" method="POST" class="space-y-5" id="passwordForm">
        <!-- Current Password (only if user has one) -->
        <% if (locals.user && user.password) { %>
        <div class="relative">
          <label for="currentPassword" class="block text-sm font-medium text-gray-700 mb-1.5">Current Password</label>
          <div class="relative">
            <input
              type="password"
              id="currentPassword"
              name="currentPassword"
              class="w-full px-3 py-2.5 pr-10 border border-gray-300 rounded-lg focus:ring-1 focus:ring-black focus:border-black outline-none transition"
              placeholder="••••••••"
            />
            <button type="button" id="toggleCurrent" class="absolute inset-y-0 right-0 flex items-center justify-center pr-3 text-gray-500 focus:outline-none">
              <svg xmlns="http://www.w3.org/2000/svg" id="eyeOffCurrent" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a10.054 10.054 0 013.01-4.423m3.76-1.999A9.958 9.958 0 0112 5c4.477 0 8.268 2.943 9.542 7a9.96 9.96 0 01-1.492 2.568M15 12a3 3 0 00-3-3m0 0a3 3 0 00-3 3m3 3a3 3 0 01-3-3m0 0a3 3 0 013-3" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3l18 18" />
              </svg>
              <svg xmlns="http://www.w3.org/2000/svg" id="eyeOnCurrent" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
              </svg>
            </button>
          </div>
        </div>
        <% } %>

        <!-- New Password -->
        <div class="relative">
          <label for="newPassword" class="block text-sm font-medium text-gray-700 mb-1.5">New Password</label>
          <div class="relative">
            <input
              type="password"
              id="newPassword"
              name="newPassword"
              minlength="8"
              class="w-full px-3 py-2.5 pr-10 border border-gray-300 rounded-lg focus:ring-1 focus:ring-black focus:border-black outline-none transition"
              placeholder="At least 8 characters"
            />
            <button type="button" id="toggleNew" class="absolute inset-y-0 right-0 flex items-center justify-center pr-3 text-gray-500 focus:outline-none">
              <svg xmlns="http://www.w3.org/2000/svg" id="eyeOffNew" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a10.054 10.054 0 013.01-4.423m3.76-1.999A9.958 9.958 0 0112 5c4.477 0 8.268 2.943 9.542 7a9.96 9.96 0 01-1.492 2.568M15 12a3 3 0 00-3-3m0 0a3 3 0 00-3 3m3 3a3 3 0 01-3-3m0 0a3 3 0 013-3" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3l18 18" />
              </svg>
              <svg xmlns="http://www.w3.org/2000/svg" id="eyeOnNew" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
              </svg>
            </button>
          </div>
          <p id="passwordHelp" class="mt-1 text-xs text-gray-500">
            Use 8+ characters with uppercase, lowercase, number & symbol (@$!%*?&).
          </p>
        </div>

        <!-- Confirm Password -->
        <div class="relative">
          <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-1.5">Confirm New Password</label>
          <div class="relative">
            <input
              type="password"
              id="confirmPassword"
              name="confirmPassword"
              minlength="8"
              class="w-full px-3 py-2.5 pr-10 border border-gray-300 rounded-lg focus:ring-1 focus:ring-black focus:border-black outline-none transition"
              placeholder="••••••••"
            />
            <button type="button" id="toggleConfirm" class="absolute inset-y-0 right-0 flex items-center justify-center pr-3 text-gray-500 focus:outline-none">
              <svg xmlns="http://www.w3.org/2000/svg" id="eyeOffConfirm" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a10.054 10.054 0 013.01-4.423m3.76-1.999A9.958 9.958 0 0112 5c4.477 0 8.268 2.943 9.542 7a9.96 9.96 0 01-1.492 2.568M15 12a3 3 0 00-3-3m0 0a3 3 0 00-3 3m3 3a3 3 0 01-3-3m0 0a3 3 0 013-3" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3l18 18" />
              </svg>
              <svg xmlns="http://www.w3.org/2000/svg" id="eyeOnConfirm" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
              </svg>
            </button>
          </div>
          <p id="confirmHelp" class="mt-1 text-xs text-gray-500"></p>
        </div>

        <div class="pt-3">
          <button
            type="submit"
            id="submitBtn"
            disabled
            class="w-full bg-black hover:bg-gray-900 text-white font-medium py-2.5 rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-gray-700 focus:ring-offset-2 opacity-50 cursor-not-allowed"
          >
            <%= (locals.user && user.password) ? 'Update Password' : 'Set Password' %>
          </button>
        </div>
      </form>
    </main>
  </div>

  <!-- Mobile Bottom Nav -->
  <div class="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-100 p-3">
    <div class="flex justify-around">
      <a href="/" class="flex flex-col items-center text-xs text-gray-600 hover:text-red-600 transition-colors">
        <i class="fas fa-home text-lg mb-1"></i>
        <span>Home</span>
      </a>
      <a href="/cart" class="flex flex-col items-center text-xs text-gray-600 hover:text-red-600 transition-colors">
        <i class="fas fa-shopping-cart text-lg mb-1"></i>
        <span>Cart</span>
      </a>
      <a href="/wishlist" class="flex flex-col items-center text-xs text-gray-600 hover:text-red-600 transition-colors">
        <i class="far fa-heart text-lg mb-1"></i>
        <span>Wishlist</span>
      </a>
      <a href="/profile" class="flex flex-col items-center text-xs text-gray-600 hover:text-red-600 transition-colors">
        <% if (user && user.profilePic) { %>
          <img src="<%= user.profilePic %>" alt="User" class="w-6 h-6 rounded-full mb-1 object-cover" />
        <% } else { %>
          <svg class="w-6 h-6 rounded-full mb-1 text-gray-500 bg-gray-100" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
          </svg>
        <% } %>
        <span>Profile</span>
      </a>
    </div>
  </div>

  <!-- Safe way to pass server messages -->
  <script id="page-data" type="application/json">
  {
    "successMessage": <%- JSON.stringify(locals.successMessage || null) %>,
    "errorMessage": <%- JSON.stringify(locals.errorMessage || null) %>
  }
</script>

  <script>
    // Password validation regex
    function validatePassword(password) {
      const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
      return regex.test(password);
    }

    document.addEventListener('DOMContentLoaded', function () {
      // Toggle password visibility
      function setupToggle(inputId, toggleId, eyeOnId, eyeOffId) {
        const input = document.getElementById(inputId);
        const toggle = document.getElementById(toggleId);
        const eyeOn = document.getElementById(eyeOnId);
        const eyeOff = document.getElementById(eyeOffId);
        if (!input || !toggle) return;
        toggle.addEventListener('click', () => {
          const isPassword = input.type === 'password';
          input.type = isPassword ? 'text' : 'password';
          eyeOff.classList.toggle('hidden', isPassword);
          eyeOn.classList.toggle('hidden', !isPassword);
        });
      }

      setupToggle('currentPassword', 'toggleCurrent', 'eyeOnCurrent', 'eyeOffCurrent');
      setupToggle('newPassword', 'toggleNew', 'eyeOnNew', 'eyeOffNew');
      setupToggle('confirmPassword', 'toggleConfirm', 'eyeOnConfirm', 'eyeOffConfirm');

      // Live validation
      const currentPass = document.getElementById('currentPassword');
      const newPass = document.getElementById('newPassword');
      const confirmPass = document.getElementById('confirmPassword');
      const passwordHelp = document.getElementById('passwordHelp');
      const confirmHelp = document.getElementById('confirmHelp');
      const submitBtn = document.getElementById('submitBtn');
      const form = document.getElementById('passwordForm');

      const hasCurrent = currentPass !== null;

      function updateValidation() {
        const np = newPass?.value || '';
        const cp = confirmPass?.value || '';
        const current = hasCurrent ? (currentPass.value || '') : true;

        // Validate new password
        let newPasswordValid = false;
        if (np === '') {
          passwordHelp.textContent = 'Use 8+ characters with uppercase, lowercase, number & symbol (@$!%*?&).';
          passwordHelp.className = 'mt-1 text-xs text-gray-500';
          newPasswordValid = false;
        } else if (validatePassword(np)) {
          passwordHelp.textContent = '✓ Strong password!';
          passwordHelp.className = 'mt-1 text-xs text-green-600 font-medium';
          newPasswordValid = true;
        } else {
          passwordHelp.innerHTML = '✗ Must include uppercase, lowercase, number, symbol, and 8+ chars.';
          passwordHelp.className = 'mt-1 text-xs text-red-600';
          newPasswordValid = false;
        }

        // Validate confirm
        let confirmValid = false;
        if (cp === '') {
          confirmHelp.textContent = '';
          confirmValid = false;
        } else if (cp !== np) {
          confirmHelp.textContent = 'Passwords do not match.';
          confirmHelp.className = 'mt-1 text-xs text-red-600';
          confirmValid = false;
        } else {
          confirmHelp.textContent = '✓ Matches!';
          confirmHelp.className = 'mt-1 text-xs text-green-600';
          confirmValid = true;
        }

        // Validate current password
        const currentValid = !hasCurrent || current.trim() !== '';

        // Enable submit button only if all valid
        const allValid = currentValid && newPasswordValid && confirmValid;
        submitBtn.disabled = !allValid;
        submitBtn.classList.toggle('opacity-50', !allValid);
        submitBtn.classList.toggle('cursor-not-allowed', !allValid);
        submitBtn.classList.toggle('hover:bg-gray-900', allValid);
      }

      // Attach live listeners
      if (newPass) newPass.addEventListener('input', updateValidation);
      if (confirmPass) confirmPass.addEventListener('input', updateValidation);
      if (currentPass) currentPass.addEventListener('input', updateValidation);

      // Form submit: prevent if invalid (safety net)
      if (form) {
        form.addEventListener('submit', function (e) {
          const np = newPass?.value || '';
          const cp = confirmPass?.value || '';
          const current = hasCurrent ? (currentPass?.value || '') : '';

          if (!validatePassword(np)) {
            e.preventDefault();
            Swal.fire({
              icon: 'error',
              title: 'Invalid Password',
              text: 'Your password does not meet the requirements.',
              confirmButtonText: 'OK'
            });
            return;
          }

          if (np !== cp) {
            e.preventDefault();
            Swal.fire({
              icon: 'error',
              title: 'Password Mismatch',
              text: 'New passwords do not match.',
              confirmButtonText: 'OK'
            });
            return;
          }

          if (hasCurrent && !current.trim()) {
            e.preventDefault();
            Swal.fire({
              icon: 'error',
              title: 'Missing Current Password',
              text: 'Please enter your current password.',
              confirmButtonText: 'OK'
            });
            return;
          }
        });
      }

      // Show server messages
      const pageDataEl = document.getElementById('page-data');
      if (pageDataEl) {
        const pageData = JSON.parse(pageDataEl.textContent);
        if (pageData.successMessage) {
          setTimeout(() => {
            Swal.fire({
              icon: 'success',
              title: 'Success!',
              text: pageData.successMessage,
              confirmButtonText: 'OK'
            });
          }, 300);
        } else if (pageData.errorMessage) {
          setTimeout(() => {
            Swal.fire({
              icon: 'error',
              title: 'Error',
              text: pageData.errorMessage,
              confirmButtonText: 'OK'
            });
          }, 300);
        }
      }
    });
  </script>
</body>
</html>