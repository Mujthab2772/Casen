<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" sizes="32x32" href="/logoTab.png">
    <title>Add New Category</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the toggle switch */
        input:checked + .toggle-bg {
            background-color: #1a202c;
        }
        input:checked + .toggle-bg .toggle-dot {
            transform: translateX(100%);
        }

        #loaderModal {
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        #loaderModal:not(.hidden) {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans antialiased">

    <!-- Sidebar: Hidden on mobile, shown on medium+ screens -->
    <aside class="hidden md:block w-[227px] bg-white border-r border-gray-200 flex flex-col fixed left-0 top-0 h-screen overflow-y-auto">
        <div class="p-6 flex items-center gap-3 border-b border-gray-200">
            <div class="w-10 h-10 bg-black rounded-md flex items-center justify-center flex-shrink-0">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="3" y="3" width="18" height="18" rx="2" fill="white"/>
                    <rect x="7" y="7" width="4" height="4" fill="black"/>
                    <rect x="13" y="7" width="4" height="4" fill="black"/>
                    <rect x="7" y="13" width="10" height="4" fill="black"/>
                </svg>
            </div>
            <span class="text-sm font-semibold text-black">Casen</span>
        </div>

        <nav class="flex-1 py-4 flex flex-col">
            <a href="/admin/dashboard" class="flex items-center gap-3 px-4 py-3 text-gray-500 text-sm transition-all duration-200 border-l-4 border-transparent hover:bg-gray-100 hover:text-black">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4z"/>
                    <path d="M3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6z"/>
                    <path d="M14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"/>
                </svg>
                <span>Dashboard</span>
            </a>

            <a href="/admin/order" class="flex items-center gap-3 px-4 py-3 text-gray-500 text-sm transition-all duration-200 border-l-4 border-transparent hover:bg-gray-100 hover:text-black">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 6H6.28l-.31-1.243A1 1 0 005 4H3z"/>
                    <path d="M16 16a2 2 0 11-4 0 2 2 0 014 0z"/>
                    <path d="M4 16a2 2 0 11-4 0 2 2 0 014 0z"/>
                </svg>
                <span>Orders</span>
            </a>

            <a href="/admin/products" class="flex items-center gap-3 px-4 py-3 text-gray-500 text-sm transition-all duration-200 border-l-4 border-transparent hover:bg-gray-100 hover:text-black">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M3 1a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V1z"/>
                    <path d="M3 5a1 1 0 011-1h12a1 1 0 011 1v12a2 2 0 01-2 2H5a2 2 0 01-2-2V5z"/>
                </svg>
                <span>Products</span>
            </a>

            <a href="/admin/customers" class="flex items-center gap-3 px-4 py-3 text-gray-500 text-sm transition-all duration-200 border-l-4 border-transparent hover:bg-gray-100 hover:text-black">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v1h8v-1zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"/>
                </svg>
                <span>Customers</span>
            </a>

            <a href="/admin/analytics" class="flex items-center gap-3 px-4 py-3 text-gray-500 text-sm transition-all duration-200 border-l-4 border-transparent hover:bg-gray-100 hover:text-black">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"/>
                </svg>
                <span>Analytics</span>
            </a>

            <a href="/admin/coupons" class="flex items-center gap-3 px-4 py-3 text-gray-500 text-sm transition-all duration-200 border-l-4 border-transparent hover:bg-gray-100 hover:text-black">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z"/>
                </svg>
                <span>Coupons</span>
            </a>

            <a href="/admin/category" class="flex items-center gap-3 px-4 py-3 text-gray-500 text-sm transition-all duration-200 border-l-4 border-transparent hover:bg-gray-100 hover:text-black bg-gray-100 text-black border-l-black">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M7 3a1 1 0 000 2h6a1 1 0 000-2H7zM4 7a1 1 0 011-1h10a1 1 0 011 1v3a2 2 0 01-2 2H6a2 2 0 01-2-2V7zm2 3a1 1 0 100 2 1 1 0 000-2z"/>
                </svg>
                <span>Categories</span>
            </a>

            <a href="/admin/offers" class="flex items-center gap-3 px-4 py-3 text-gray-500 text-sm transition-all duration-200 border-l-4 border-transparent hover:bg-gray-100 hover:text-black">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M4.5 3a2.5 2.5 0 015 0V4h4V3a2.5 2.5 0 015 0v1h2.006a1 1 0 01.994.89l1.348 13.48A2 2 0 0118.334 20H1.666a2 2 0 01-1.994-2.21L1 4.89A1 1 0 012 4h2V3a2.5 2.5 0 012.5-2.5z"/>
                </svg>
                <span>Offer</span>
            </a>
        </nav>

        <div class="p-4 border-t border-gray-200 absolute inset-x-0 bottom-0">
            <div class="flex items-center gap-3 mb-4">
                <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center font-semibold text-blue-800 flex-shrink-0">A</div>
                <div class="min-w-0">
                    <div class="text-xs font-semibold text-black">Admin</div>
                    <div class="text-[0.625rem] text-gray-500 truncate">admin@example.com</div>
                </div>
            </div>
            <form action="/admin/logout" method="post">
                <button class="w-full flex items-center justify-center gap-2 py-2 bg-gray-100 border-none rounded-md text-black text-sm cursor-pointer transition-all duration-200 hover:bg-gray-200">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M10.5 1.5H3a1.5 1.5 0 00-1.5 1.5v10a1.5 1.5 0 001.5 1.5h7.5a1.5 1.5 0 001.5-1.5v-4"/>
                        <path d="M10.5 5l3-3m0 0l-3-3m3 3H6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                    </svg>
                    Logout
                </button>
            </form>
        </div>
    </aside>

    <!-- Main Content Area: Full width on mobile, offset on md+ -->
    <div class="ml-0 md:ml-[227px] transition-all duration-200">
        <div class="container mx-auto max-w-4xl p-4 md:p-8">
            
            <!-- Back Link -->
            <a href="/admin/category" class="inline-flex items-center text-gray-600 hover:text-gray-900 mb-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                </svg>
                Back to Category Management
            </a>

            <!-- Page Header -->
            <div class="mb-6">
                <h1 class="text-3xl font-bold text-gray-900">Add New Category</h1>
                <p class="text-gray-600 mt-1">Create a new category for your products.</p>
            </div>

            <!-- Form Card -->
            <div class="bg-white rounded-lg shadow-md p-6 md:p-8">
                <form id="addCategoryForm" action="/admin/addCategory" method="POST" enctype="multipart/form-data">
                    <div class="space-y-6">
                        
                        <!-- Category Name -->
                        <div>
                            <label for="category-name" class="block text-sm font-medium text-gray-700 mb-1">
                                Category Name
                            </label>
                            <input 
                                type="text" 
                                id="category-name" 
                                name="categoryName"
                                placeholder="e.g., iPhone 15 Pro Max Cases"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-gray-800 focus:border-gray-800"
                            >
                            <p style="color: red;"><%= error %></p>
                        </div>
                        
                        <!-- Description -->
                        <div>
                            <label for="description" class="block text-sm font-medium text-gray-700 mb-1">
                                Description
                            </label>
                            <textarea 
                                id="description" 
                                name="description" 
                                rows="4"
                                placeholder="A brief description of the category."
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-gray-800 focus:border-gray-800"
                            ></textarea>
                        </div>

                        <!-- Category Image -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">
                                Category Image
                            </label>
                            <div id="drop-area" class="mt-1 flex justify-center px-4 pt-4 pb-6 md:px-6 md:pt-5 md:pb-6 border-2 border-gray-300 border-dashed rounded-lg">
                                <div class="space-y-1 text-center">
                                    <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true">
                                        <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                    </svg>
                                    <div class="flex text-sm text-gray-600">
                                        <label for="file-upload" class="relative cursor-pointer bg-white rounded-md font-medium text-gray-800 hover:text-gray-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-gray-500">
                                            <span>Upload a file</span>
                                            <input id="file-upload" name="fileUpload" type="file" class="sr-only">
                                        </label>
                                        <p class="pl-1">or drag and drop</p>
                                    </div>
                                    <p class="text-xs text-gray-500">
                                        PNG, JPG, GIF up to 10MB
                                    </p>

                                    <div id="preview-container" class="mt-4 hidden">
                                        <img id="preview-image" class="mx-auto rounded-lg shadow-md max-h-48 object-contain" />
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="flex justify-end items-center gap-4 mt-8 pt-6 border-t border-gray-200">
                            <button 
                                type="button"
                                onclick="window.location.href='/admin/category'"
                                class="px-6 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors"
                            >
                                Cancel
                            </button>
                            <button 
                                type="submit"
                                class="px-6 py-2 bg-gray-900 border border-transparent rounded-lg text-sm font-medium text-white hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-900 transition-colors"
                            >
                                Create Category
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Loader Modal -->
    <div id="loaderModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden z-50">
        <div class="bg-white rounded-lg p-6 text-center">
            <svg class="animate-spin h-8 w-8 text-gray-900 mx-auto mb-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
            </svg>
            <p class="text-gray-700">Uploading category...</p>
        </div>
    </div>

    <script>
        const form = document.getElementById("addCategoryForm");
        const loader = document.getElementById("loaderModal");

        form.addEventListener("submit", () => {
            loader.classList.remove("hidden");
        });

        const fileInput = document.getElementById("file-upload");
        const dropArea = document.getElementById("drop-area");
        const previewContainer = document.getElementById("preview-container");
        const previewImage = document.getElementById("preview-image");

        const showPreview = (file) => {
            if (file && file.type.startsWith("image/")) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    previewImage.src = e.target.result;
                    previewContainer.classList.remove("hidden");
                };
                reader.readAsDataURL(file);
            } else {
                previewContainer.classList.add("hidden");
            }
        };

        fileInput.addEventListener("change", (event) => {
            const file = event.target.files[0];
            showPreview(file);
        });

        ["dragenter", "dragover", "dragleave", "drop"].forEach((eventName) => {
            dropArea.addEventListener(eventName, (e) => e.preventDefault());
            dropArea.addEventListener(eventName, (e) => e.stopPropagation());
        });

        ["dragenter", "dragover"].forEach((eventName) => {
            dropArea.addEventListener(eventName, () => dropArea.classList.add("border-blue-400"));
        });

        ["dragleave", "drop"].forEach((eventName) => {
            dropArea.addEventListener(eventName, () => dropArea.classList.remove("border-blue-400"));
        });

        dropArea.addEventListener("drop", (event) => {
            const file = event.dataTransfer.files[0];
            if (file) {
                showPreview(file);
            }
        });
    </script>
</body>
</html>